#архитектура 
# Варианты архитектур систем
## Монолит
Все одним куском
Плюсы:
1) упрощенная разработка
2) меньше сквозных проблем
3) хорошая производительность
Минусы:
1) разработка усложняется с ростом команды
2) большая связанность кода
3) сложность внедрения новых технологий
4) сложномть при масштабировании

SOA - разделили на какие-то области (домены), но с общей бд
С общей шиной(очередью сообщений)

## Микросервисы
Плюсы:
1) слабая связанность кода и небольшая кодовая база
2) лешко разрабатывать, тестировать и развертывать
3) простое горизонтальное мащтабирование

Минусы:
1) Сложно делить зоны ответственности
2) Проблемы с безопасностью (в каждом микросервисе нужно проверять кто стучится, то есть свою систему авторизации)
3) Возможность использовать разные языки

Чтобы разобраться с безопасностью можно использовать прослойку между UI и микросерчисами - API Gateway

# Виды взаимодействия
## Синхронное взаимодействие 
клиент ожидает ответа от сервера и только после получения ответа продолжает работать

Версионирование - через sub_path(это штука между слэшами) и серез header-ы(но это странно)
пример sub_path - https://..../api/v1/method
очевидно, что версия только мажорная, так как нам интересна лишь обратная совместимость

## Асинхронное
Предполагается продолжение работы клиентом в то время пока сервер работает
Примеры: RabbitMQ, WebSocket, WebHook, short-polling

short-polling - раз в N секунд долбим сервак
long-polling - один раз установили коннект и нас сервак говорит, когда есть изменение
Web hooks - запрос, которые ожидают ответы от сервера за счет вызова своего отдельного метода
Web sockets - двунаправленное соединение (чаты напрмер)
Очередь - система очередей, позволяющая публиковать и пожписываться на сообщения

# Отказоустойчивость
1) Timeout - при долгих запросах устанавливаем порого времени
2) Throttle  - из набора зарпросов пропускает лишь один - первый (типа обрабатываем один и засыпаем)
3) Fallback - при ошибке запроса, что-то делаем
4) Debounce - пропускает лишь один - последний
5) Retry - повторяет запрос при ошибке
6) Circuit Breaker - при попытках соединения сервера, при определенном числе ошибок говорим клиенту ошибка, а потом по ряду фиббоначи проверяем и когда получаем положительный ответ, помечаем, что все хорошо

# Cloud Native
1) Cloud Ready - приложению не требуется доступ к диску, оно контейнеризованно, а управление с внешними сервисами осуществляется за счет конфигов
2) Cloud Friendly - приложение 12 факторов![[Pasted image 20231017192930.png]]
3) Cloud Resilient - отказ отдельных компонент не приведет к недоступности сервиса(типа поднимаем что-то дополнительно, если тяжело)
4) Cloud Native - микросевисная архитектура , используется принцип API-first(между сервисами контракты)
# Виртуализация или контейнер
Виртуальная машина - нужна была, чтобы разделять серверные мощности для нескольких клиентов
Контейнеры - образы системы маленькие, только то что нужно, напрмер ядро, но инфраструктура, как у виртуалки

## Docker
Images - схемы нашего приложения (не запущен)
Container - instance image
Docker Deamon - фоновый процесс
Docker Client - утилита для работы с демоном
Docker Registry - хранитель образов
Docker Hub - ...
Docker File - файл, который описывает на основе чего мы создаем свой образ
Docker Compose - инструмент, который помогает оркестрировать docker контейнеры

# Docker WorkShop
https://gitlab.com/getBolted/docker-workshop